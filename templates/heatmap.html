<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Parking Occupancy Heatmap</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <header>
        <h2>ðŸš— Parking Occupancy Heatmap</h2>
        <nav>
            <a href="/">Live Map</a> |
            <a href="/heatmap">Heatmap</a> |
            <a href="/predictor">Predictor</a>
        </nav>
    </header>

    <main>
        <div class="card">
            <h3>Occupancy Intensity by Day & Hour</h3>
            <canvas id="heatmapChart" width="800" height="400"></canvas>
        </div>
    </main>

    <script>
        const heatmapData = {{ heatmap_data | tojson }};
        const days = Object.keys(heatmapData);
        const hours = Array.from({ length: 24 }, (_, i) => i + ":00");
        const datasets = days.map((day, idx) => ({
            label: day,
            data: heatmapData[day] || Array(24).fill(0),
            borderWidth: 1,
            backgroundColor: `rgba(${(idx * 40) % 255}, ${(idx * 90) % 255}, 255, 0.4)`
        }));

        new Chart(document.getElementById("heatmapChart"), {
            type: "line",
            data: { labels: hours, datasets },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: "Avg Occupancy Duration (sec)" } },
                    x: { title: { display: true, text: "Hour of Day" } }
                }
            }
        });
    </script>
</body>

</html>